setwd("projects/DNA-methylation-signatures-of-duplicate-gene-evolution-in-angiosperms/scripts/analyses_R/Athaliana/")
df1 <- read.table("methylpy/results/Athaliana_classified_genes.tsv",header=TRUE,sep="\t")
head(df1)
library(ggplot2)
library(reshape2)
library(scales)
df2 <- melt(df1[c(2,6)])
head(df2)
df2 <- melt(df1[c(23,6)])
head(df1)
head(df2)
ggplot(df2) + geom_boxplot(aes(y=value,fill=Classification))
df2 <- melt(df1[c(23,11)])
ggplot(df2) + geom_boxplot(aes(y=value,fill=Classification))
ggplot(df2[df2$Classification != "TE-like"]) + geom_boxplot(aes(y=value,fill=Classification))
ggplot(df2[df2$Classification != "TE-like",]) + geom_boxplot(aes(y=value,fill=Classification))
df2 <- melt(df1[c(23,16)])
ggplot(df2[df2$Classification != "TE-like",]) + geom_boxplot(aes(y=value,fill=Classification))
df2[df2$Classification != "Unclassified",]
median(df2[df2$Classification != "Unclassified",]$value)
median(df2[df2$Classification != "Unclassified",]$value,na.rm = T)
mean(df2[df2$Classification != "Unclassified",]$value,na.rm = T)
df2 <- melt(df1[c(23,6)])
mean(df2[df2$Classification != "Unclassified",]$value,na.rm = T)
median(df2[df2$Classification != "Unclassified",]$value,na.rm = T)
ggplot(df2[df2$Classification != "TE-like",]) + geom_boxplot(aes(y=value,fill=Classification))
ggplot(df2[df2$Classification != "Unclassified",]) + geom_bar(aes(x=value,fill=Classification))
ggplot(df2[df2$Classification != "Unclassified",]) + geom_bar(aes(x=value))
ggplot(df2[df2$Classification != "Unclassified",]) + geom_histogram(aes(x=value))
ggplot(df2[df2$Classification != "Unclassified",]) + geom_density(aes(x=value))
ggplot(df2[df2$Classification != "Unclassified",]) + geom_bar(aes(x=value))
head(df1)
df1$C_Weighted_mC <- (df1$CG_Methylated_Reads+df1$CHG_Methylated_Reads+df1$CHH_Methylated_Reads)/(df1$CG_Total_Reads+df1$CHG_Total_Reads+df1$CHH_Total_Reads)
head(df1)
df2 <- melt(df1[c(23,24)])
ggplot(df2[df2$Classification != "TE-like",]) + geom_boxplot(aes(y=value,fill=Classification))
mean(df2[df2$Classification != "Unclassified",]$value)
mean(df2[df2$Classification != "Unclassified",]$value,na.rm=T)
median(df2[df2$Classification != "Unclassified",]$value,na.rm=T)
nrow(df2[df2$Classification != "Unclassified",]$value < 0.01)
nrow(na.omit(df2[df2$Classification != "Unclassified",]$value) < 0.01)
nrow(df2[df2$Classification != "Unclassified",]$value)
nrow(df2[df2$Classification != "Unclassified",])
nrow(df2[df2$Classification != "Unclassified" && df2$value<0.01,])
nrow(na.omit(df2[df2$Classification != "Unclassified" && df2$value<0.01,])
)
median(df2[df2$Classification == "Unclassified",]$value,na.rm=T)
mean(df2[df2$Classification == "Unclassified",]$value,na.rm=T)
nrow(df2[df2$Classification != "Unclassified" & df2$value<0.01,])
nrow(df2[df2$Classification == "Unclassified" & df2$value<0.01,])
nrow(df2[df2$Classification == "Unclassified" & df2$value > 0.01,])
